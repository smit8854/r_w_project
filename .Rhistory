rw.pc <-
merge(
merge(
merge(
merge(
merge(
rw.parcoord.targ.r,
rw.parcoord.targ.w, by="subject"),
rw.parcoord.transc.r, by="subject"),
rw.parcoord.transc.wr, by="subject"),
rw.parcoord.transc.w, by="subject"),
rw.parcoord.transc.rw, by="subject")
ggparcoord(rw.pc,
columns = 2:7, groupColumn = 1
) +
theme_tufte()
rw.parcoord.transc.r <- rw.merge %>% filter(transc=="r") %>% group_by(subject) %>% summarise(mean.transc.r = mean(rating))
rw.parcoord.transc.w <- rw.merge %>% filter(transc=="w") %>% group_by(subject) %>% summarise(mean.transc.w = mean(rating))
rw.parcoord.transc.rw <- rw.merge %>% filter(transc=="rw") %>% group_by(subject) %>% summarise(mean.transc.rw = mean(rating))
rw.parcoord.transc.wr <- rw.merge %>% filter(transc=="wr") %>% group_by(subject) %>% summarise(mean.transc.wr = mean(rating))
rw.parcoord.targ.r <- rw.merge %>% filter(target=="r") %>% group_by(subject) %>% summarise(mean.targ.r = mean(rating))
rw.parcoord.targ.w <- rw.merge %>% filter(target=="w") %>% group_by(subject) %>% summarise(mean.targ.w = mean(rating))
rw.pc <-
merge(
merge(
merge(
merge(
merge(
rw.parcoord.targ.r,
rw.parcoord.targ.w, by="subject"),
rw.parcoord.transc.r, by="subject"),
rw.parcoord.transc.wr, by="subject"),
rw.parcoord.transc.w, by="subject"),
rw.parcoord.transc.rw, by="subject")
ggparcoord(rw.pc,
columns = 2:7, groupColumn = 1
) +
theme_tufte()
ggparcoord(rw.pc,
columns = 2:7, groupColumn = 1
) +
theme_tufte()+scale_colour_manual(values="grey")
ggparcoord(rw.pc,
columns = 2:7, groupColumn = 1
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))
ggparcoord(rw.pc,
columns = 2:7, groupColumn = 1
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
ggparcoord(rw.pc,
columns = c(2,4), groupColumn = 1
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
ggparcoord(rw.pc,
columns = c(2,4,7), groupColumn = 1
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
ggparcoord(rw.pc,
columns = c(2,4,7,5,6), groupColumn = 1
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
ggparcoord(rw.pc,
columns = c(2,4,7,5,6), groupColumn = 1, scale="uniminmax"
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
ggparcoord(rw.pc,
columns = c(2,4,7,5,6,3), groupColumn = 1, scale="uniminmax"
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
ggparcoord(rw.pc,
columns = c(2,4,7,5,6,3), groupColumn = 1, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
rw.pc2 <- rw.pc %>% mutate(goodR = (mean.targ.r<.4)*1)
head(rw.pc2)
rw.pc2 <- rw.pc %>% mutate(goodR = (mean.targ.r<.4)*1)
ggparcoord(rw.pc2,
columns = c(2,4,7,5,6,3), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
summary(rw.pc2$goodR)
rw.pc2 <- rw.pc %>% mutate(goodR = as.factor((mean.targ.r<.4)*1))
ggparcoord(rw.pc2,
columns = c(2,4,7,5,6,3), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=rep("grey", 41))+theme(legend.position = "none")
ggparcoord(rw.pc2,
columns = c(2,4,7,5,6,3), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=cbPalette)+theme(legend.position = "none")
ggparcoord(rw.pc2,
columns = c(2,4,7,5,6,3), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=c("red", "blue"))
rw.pc2 <- rw.pc %>% mutate(goodR = as.factor((mean.targ.r<.4)*1))
ggparcoord(rw.pc2,
columns = c(4,7,5,6), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=c("red", "blue"))
ggparcoord(rw.pc2,
columns = c(2,4,7,5,6), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=c("red", "blue"))
ggparcoord(rw.pc2,
columns = c(3,2,4,7,5,6), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=c("red", "blue"))
rw.pc2 <- rw.pc %>% mutate(goodR = as.factor((mean.targ.r<.3)*1))
ggparcoord(rw.pc2,
columns = c(3,2,4,7,5,6), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=c("red", "blue"))
rw.pc.w <- rw.pc %>% mutate(goodW = as.factor((mean.targ.w<.7)*1))
ggparcoord(rw.pc.w,
columns = c(3,2,4,7,5,6), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=c("red", "blue"))
ggplot(data=rw.pc, aes(x=mean.targ.w, y=mean.targ.r))+geom_point()+
theme_tufte()
ggplot(data=rw.pc, aes(x=mean.targ.w, y=mean.targ.r))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
rw.pc.w <- rw.pc %>% mutate(goodW = as.factor(1-(mean.targ.w<.7)*1))
ggparcoord(rw.pc.w,
columns = c(3,2,4,7,5,6), groupColumn = 8, scale="globalminmax"
) +
theme_tufte()+scale_colour_manual(values=c("red", "blue"))
ggplot(data=rw.pc, aes(x=mean.transc.w, y=mean.transc.r))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
ggplot(data=rw.pc, aes(x=mean.transc.w, y=mean.transc.wr))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
ggplot(data=rw.pc, aes(x=mean.transc.w, y=mean.transc.rw))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
ggplot(data=rw.pc, aes(x=mean.transc.wr, y=mean.transc.rw))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
ggplot(data=rw.pc, aes(x=mean.transc.r, y=mean.transc.rw))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
ggplot(data=rw.pc, aes(x=mean.transc.r, y=mean.transc.w))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
ggplot(data=rw.pc, aes(x=mean.transc.r, y=mean.transc.wr))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
ggplot(data=rw.pc, aes(x=mean.transc.w, y=mean.transc.wr))+geom_point()+
theme_tufte()+
scale_x_continuous(limits=c(0,1))+  scale_y_continuous(limits=c(0,1))
rw.merge <- read.csv("C:\\Users\\tenni\\OneDrive\\Documents\\GitHub\\r_w_project\\data\\rw_merge.csv")
acous <- read.csv("C:\\Users\\tenni\\OneDrive\\Documents\\GitHub\\r_w_project\\data\\acoustic.csv")
head(rw.merge)
library(gtheory)
gtheory::gstudy(data = rw.merge, formula = rating ~ Listener + subject + word.x)
gtheory::gstudy(data = rw.merge, formula = rating ~ target + 1|Listener + 1|subject + 1|word.x)
gtheory::gstudy(data = rw.merge, formula = rating ~ 1|Listener + 1|subject + 1|word.x)
gtheory::dstudy(data = rw.merge, formula = rating ~ 1|Listener + 1|subject + 1|word.x)
gtheory::dstudy(data = rw.merge, formula = rating ~ target + 1|Listener + 1|subject + 1|word.x)
gtheory::gstudy(data = rw.merge, formula = rating ~ target + 1|Listener + 1|subject + 1|word.x)
library(tidyverse)
library(gtheory)
rw.merge %>% select(rating, target, Listener, subject, word.x) -> rw.gt
gtheory::gstudy(data = rw.gt, formula = rating ~ target + 1|Listener + 1|subject + 1|word.x)
head(rw.gt)
rw.merge %>% select(rating, target, Listener, subject, word.x) %>% filter(!is.na(rating)) -> rw.gt
head(rw.gt)
rw.merge %>% mutate(Target=is.factor(target)) %>% select(rating, Target, Listener, subject, word.x) %>% filter(!is.na(rating)) -> rw.gt
head(rw.gt)
rw.merge %>% select(rating, target, Listener, subject, word.x) %>% filter(!is.na(rating)) -> rw.gt
summary(rw.gt)
rw.merge %>%
mutate(
Target=as.factor(target),
Rater=as.factor(Listerner),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Listener, subject, word.x) %>%
filter(!is.na(rating)) ->
rw.gt
rw.merge %>%
mutate(
Target=as.factor(target),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Listener, subject, word.x) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = rating ~ target + 1|Listener + 1|subject + 1|word.x)
gtheory::gstudy(data = rw.gt, formula = rating ~ Target + 1|Rater + 1|Child + 1|Word)
rw.merge %>%
mutate(
Target=as.factor(target),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Listener, Rater, Word) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = rating ~ Target + 1|Rater + 1|Child + 1|Word)
rw.merge %>%
mutate(
Target=as.factor(target),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Rater, Child, Word) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = rating ~ Target + 1|Rater + 1|Child + 1|Word)
rw.merge %>%
mutate(
Target=as.factor(target),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Rater, Child, Word) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = rating ~ Target + Rater + Child + Word + 1|Rater + 1|Child + 1|Word)
gtheory::gstudy(data = rw.gt, formula = rating ~ Target + 1|Rater + 1|Child + 1|Word)
gtheory::gstudy(data = rw.gt, formula = rating ~ `Target` + 1|`Rater` + 1|`Child` + 1|`Word`)
gtheory::gstudy(data = rw.gt, formula = rating ~ `Target` + 0|`Rater` + 0|`Child` + 0|`Word`)
gtheory::gstudy(data = rw.gt, formula = "rating ~ `Target` + 0|`Rater` + 0|`Child` + 0|`Word`")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + 0|Rater + 0|Child + 0|Word")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + 1|Rater + 1|Child + 1|Word")
rw.merge %>%
mutate(
Target=as.factor(target),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Rater, Child, Word) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = "rating ~ 1|Rater")
gtheory::gstudy(data = rw.gt, formula = "rating ~ 1|Rater + 1|Child")
gtheory::gstudy(data = rw.gt, formula = "rating ~ (1|Rater + Child + Word)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ (1|Rater) + (1|Child)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ (1|Rater) + (1|Child) + (1|Word)")
head(rw.merge)
rw.merge %>%
mutate(
Target=as.factor(target),
Transcription=as.factor(transc),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Transcription, Rater, Child, Word) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target*Transcription + (1|Rater) + (1|Child) + (1|Word)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + Transcription + (1|Rater) + (1|Child) + (1|Word)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + (1|Rater) + (1|Child) + (1|Word)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + (1|Rater) + (1|Child) + (1|Word)")
head(rw.merge)
rw.merge %>%
mutate(
Target=as.factor(target),
Transcription=as.factor(transc),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Transcription, Rater, f3f2, Child, Word) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + (1|Rater) + (1 + f3f2|Child) + (1|Word)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + Word + (1|Rater) + (1 + f3f2|Child)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + (1|Rater) + (1 + f3f2|Child)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + f3f2 + (1|Rater) + (1|Child)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + f3f2 + f3 + (1|Rater) + (1|Child)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + f3f2 + f3 + (1|Rater) + (1|Child)")
rw.merge %>%
mutate(
Target=as.factor(target),
Transcription=as.factor(transc),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(rating, Target, Transcription, Rater, f3f2, f3, Child, Word) %>%
filter(!is.na(rating)) ->
rw.gt
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + f3f2 + f3 + (1|Rater) + (1|Child)")
library(tidyverse)
library(gtheory)
library(lme4)
lmer(data = rw.gt, formula = "rating ~ Target + f3f2 + f2 + (1|Rater) + (1|Child)")
lmer(data = rw.gt, formula = "rating ~ Target + f3f2 + f3 + (1|Rater) + (1|Child)")
lmer(data = rw.gt, formula = "rating ~ Target + f3f2 + f3 + (1|Rater) + (1|Child)") -> rw.MEmodel
summary(rw.MEmodel)
lmer(data = rw.gt, formula = "rating ~ Target + f3f2 + (1|Rater) + (1|Child)") -> rw.MEmodel
summary(rw.MEmodel)
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + f3f2 + (1|Rater) + (1|Child)")
head(rw.merge)
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + f3f2 + (1|Transcription) + (1|Child)")
gtheory::gstudy(data = rw.gt, formula = "rating ~ Target + f3f2 + Transcription + (1|Child)")
names(rw.merge)
table(rw.merge$transc)
table(rw.merge$tran)
table(rw.merge$tran, rw.merge$transc)
rw.merge %>%
mutate(
R.Indicator=1*(trancs=="r"),
R.plus.Indicator=1*(tran %in% c("r", "$r", "$r:w")),
Target=as.factor(target),
Transcription=as.factor(transc),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(
rating,
R.Indicator,
R.plus.Indicator,
Target,
Transcription,
Rater,
f3f2,
f3,
Child,
Word
) %>%
filter(!is.na(rating)) ->
rw.clean
rw.merge %>% filter(tran=="w", transc=="wr")
rw.merge %>% filter(tran=="w", transc=="wr") %>% view()
head(acous)
acous %>% filter(word %in% c("wet", "water"), ChildID=="607L49MS4")
rw.merge %>%
mutate(
R.Indicator=1*(trancs="r"),
R.plus.Indicator=1*(tran %in% c("r", "$r", "$r:w")),
Target=as.factor(target),
Transcription=as.factor(transc),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(
rating,
R.Indicator,
R.plus.Indicator,
Target,
Transcription,
Rater,
f3f2,
f3,
Child,
Word
) %>%
filter(!is.na(rating)) ->
rw.clean
rw.merge %>%
mutate(
R.Indicator=1*(trancs=="r"),
R.plus.Indicator=1*(tran %in% c("r", "$r", "$r:w")),
Target=as.factor(target),
Transcription=as.factor(transc),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(
rating,
R.Indicator,
R.plus.Indicator,
Target,
Transcription,
Rater,
f3f2,
f3,
Child,
Word
) %>%
filter(!is.na(rating)) ->
rw.clean
rw.merge %>%
mutate(
R.Indicator=1*(transc=="r"),
R.plus.Indicator=1*(tran %in% c("r", "$r", "$r:w")),
Target=as.factor(target),
Transcription=as.factor(transc),
Rater=as.factor(Listener),
Child=as.factor(subject),
Word=as.factor(word.x)
) %>%
select(
rating,
R.Indicator,
R.plus.Indicator,
Target,
Transcription,
Rater,
f3f2,
f3,
Child,
Word
) %>%
filter(!is.na(rating)) ->
rw.clean
r.glmer.mdl.base <- glmer(
R.Indicator ~
f3f2 + (1|Child)
,
data = rw.clean
, family = poisson(link="logit")
)
r.glmer.mdl.base <- glmer(
R.Indicator ~
f3f2 + (1|Child)
,
data = rw.clean
, family = binomial(link="logit")
)
r.glmer.logbin.mdl.base <- glmer(
R.Indicator ~
f3f2 + (1|Child)
,
data = rw.clean
, family = poisson(link="log")
)
# Type 3 SS
Anova(r.glmer.mdl.logbin.base,Type="III")
library(car)
Anova(r.glmer.mdl.logbin.base,Type="III")
table(rw.clean$R.Indicator)
r.glmer.mdl.base <- glmer(
R.Indicator ~
f3f2 + (1|Child)
,
data = rw.clean,
family = binomial(link="logit"),
tol=.005
)
r.glmer.mdl.base <- glmer(
R.Indicator ~
f3f2 + (1|Child)
,
data = rw.clean,
family = binomial(link="logit"),
tolerance=.005
)
r.glmer.mdl.base <- glmer(
R.Indicator ~
I(scale(f3f2)) + (1|Child)
,
data = rw.clean,
family = binomial(link="logit"),
tolerance=.005
)
r.glmer.mdl.base <- glmer(
R.Indicator ~
I(scale(f3f2)) + (1|Child)
,
data = rw.clean,
family = binomial(link="logit")
)
Anova(r.glmer.mdl.base,Type="III")
summary(r.glmer.mdl.base)
exp(-.2155)
r.glmer.logbin.mdl.base <- glmer(
R.Indicator ~
I(scale(f3f2)) + (1|Child)
,
data = rw.clean,
family = poisson(link="log")
)
Anova(r.glmer.mdl.logbin.base,Type="III")
r.glmer.logbin.mdl.base
Anova(r.glmer.logbin.mdl.base,Type="III")
summary(r.glmer.logbin.mdl.base)
lmer(data = rw.gt, formula = "rating ~ f3f2 + (1|Child)") -> rw.MEmodel
summary(rw.MEmodel)
library(MuMIn)
r.squaredGLMM(r.glmer.logbin.mdl.base)
r.squaredLR(r.glmer.logbin.mdl.base)
lmer(data = rw.gt, formula = "rating ~ f3f2 + (1|Child)") -> rw.MEmodel
summary(rw.MEmodel)
r.squaredLR(rw.MEmodel)
gtheory::gstudy(data = rw.clean, formula = "rating ~ f3f2 + (1|Child)")
# regression coefficients
summary(r.glmer.logbin.mdl.base)
gtheory::gstudy(data = rw.clean, formula = "rating ~ Target + f3f2 + (1|Rater) + (1|Child)")
gtheory::gstudy(data = rw.clean, formula = "R.Indicator ~ Target + f3f2 + (1|Rater) + (1|Child)")
gtheory::gstudy(data = rw.clean, formula = "R.Indicator ~ f3f2 + (1|Rater) + (1|Child)")
gtheory::gstudy(data = rw.clean, formula = "rating ~ f3f2 + (1|Rater) + (1|Child)")
r.glmer.logbin.mdl.rating <- glmer(
R.Indicator ~
rating + (1|Child)
,
data = rw.clean,
family = poisson(link="log")
)
# Type 3 SS
Anova(r.glmer.logbin.mdl.rating,Type="III")
# regression coefficients
summary(r.glmer.logbin.mdl.rating)
r.squaredGLMM(r.glmer.logbin.mdl.rating)
r.squaredLR(r.glmer.logbin.mdl.rating)
rw.merge %>% distinct(word.x)
